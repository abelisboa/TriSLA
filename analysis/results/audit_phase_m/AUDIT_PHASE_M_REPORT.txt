============================================================
AUDITORIA REMOTA READ-ONLY - FASE M (ML-NSMF)
Data: ter 02 dez 2025 20:07:19 -03
Host: ppgca
Diretório: /home/porvir5g/gtp5g
============================================================

1. STATUS OPERACIONAL REAL DO ML-NSMF NO NASP
============================================================

POD EM EXECUÇÃO:
- Nome: trisla-ml-nsmf-8458884946-gnrdg
- Status: Running
- Ready: True (1/1)
- IP: 10.233.102.165
- Node: node1 (192.168.10.16)
- Uptime: ~5h43m
- Restarts: 0

POD COM PROBLEMA:
- Nome: trisla-ml-nsmf-6bc8bcbb7c-ptbh4
- Status: ImagePullBackOff
- Problema: Falha ao recuperar image pull secret (ghcr-secret)
- Tentativas: 1176+ ao longo de 4h19m

IMAGEM EM EXECUÇÃO:
- Imagem atual: ghcr.io/abelisboa/trisla-ml-nsmf:v3.7.0-nasp
- Image ID: sha256:b7aff72cfa310664338b1cb9700c34e5c610d332b5b784c2386d39d2e703625d
- Configuração Helm: v3.7.3-nasp (DIVERGÊNCIA DETECTADA)

RECURSOS:
- CPU: Request 1, Limit 4
- Memória: Request 1Gi, Limit 4Gi
- Porta: 8081/TCP

============================================================
2. FUNCIONAMENTO DE I-02/I-03
============================================================

I-02 (DECISION ENGINE → ML-NSMF):
- Status: NÃO DETECTADO
- Logs I-02: Nenhuma entrada encontrada
- Integração: Não confirmada operacionalmente

I-03 (ML-NSMF → BC-NSSMF):
- Status: NÃO DETECTADO
- Logs I-03: Nenhuma entrada encontrada
- Integração: Não confirmada operacionalmente

============================================================
3. LOGS CRÍTICOS COLETADOS
============================================================

LOGS ML-NSMF (Últimas 500 linhas):
- Apenas health checks (GET /health HTTP/1.1 200 OK)
- Nenhuma predição registrada
- Nenhum erro ou warning
- Nenhuma requisição de predição
- Nenhuma mensagem Kafka
- Nenhuma integração I-02 ou I-03

LOGS DECISION ENGINE:
- Nenhuma referência ao ML-NSMF encontrada
- Nenhuma chamada HTTP para ML-NSMF detectada

PREDIÇÕES REALIZADAS:
- Últimas 24h: NENHUMA predição encontrada nos logs
- Nenhuma entrada com palavras-chave: prediction, predict, viability, feasibility, score

============================================================
4. INTEGRIDADE DOS ARQUIVOS REAIS
============================================================

ESTRUTURA NO CONTAINER (/app):
- /app/models/scaler.pkl (EXISTE)
- /app/models/viability_model.pkl (EXISTE)
- /app/models/model_metadata.json (EXISTE)
- /app/src/ (EXISTE)
- /app/requirements.txt (EXISTE)

ESTRUTURA NO REPOSITÓRIO LOCAL:
- apps/ml_nsmf/Dockerfile (EXISTE - 659 bytes)
- apps/ml_nsmf/src/ (NÃO ENCONTRADO)
- apps/ml_nsmf/models/ (NÃO EXISTE)
- Código fonte Python: NÃO ENCONTRADO no repositório

DIVERGÊNCIA CRÍTICA:
- Código fonte não está presente no repositório local
- Apenas Dockerfile está disponível
- Modelos e código estão apenas dentro da imagem container

============================================================
5. DIVERGÊNCIAS NODE1 → SNAPSHOT → LOCAL
============================================================

VERSÃO DA IMAGEM:
- Helm values-nasp.yaml: v3.7.3-nasp
- Pod em execução: v3.7.0-nasp
- CLASSIFICAÇÃO: BLOQUEANTE (versão desatualizada)

SERVIÇO KUBERNETES:
- Service ML-NSMF: NÃO ENCONTRADO
- CLASSIFICAÇÃO: BLOQUEANTE (sem service, outros pods não podem alcançar)

CÓDIGO FONTE:
- Repositório local: Apenas Dockerfile
- Container: Código completo presente
- CLASSIFICAÇÃO: NÃO BLOQUEANTE (código está na imagem)

MODELOS:
- Repositório local: Não existem
- Container: Modelos presentes e íntegros
- CLASSIFICAÇÃO: NÃO BLOQUEANTE (modelos estão na imagem)

SNAPSHOT:
- Nenhum snapshot encontrado para comparação
- CLASSIFICAÇÃO: AMBIENTAL (não disponível)

============================================================
6. CLASSIFICAÇÃO DE RISCOS
============================================================

RISCO BLOQUEANTE:
1. Versão desatualizada (v3.7.0-nasp vs v3.7.3-nasp)
2. Service Kubernetes ausente (impede comunicação)
3. Pod duplicado em ImagePullBackOff (indica problema de configuração)
4. Nenhuma integração I-02/I-03 operacional

RISCO NÃO BLOQUEANTE:
1. Código fonte ausente no repositório (mas presente na imagem)
2. Modelos ausentes no repositório (mas presentes na imagem)
3. Apenas health checks nos logs (serviço não está sendo utilizado)

RISCO AMBIENTAL:
1. Image pull secret com warnings (mas pod está rodando)
2. Nenhum snapshot disponível para comparação

============================================================
7. IMPACTO NO PROCESSO DE ESTABILIZAÇÃO DA FASE M
============================================================

IMPACTO CRÍTICO:
- ML-NSMF não está sendo utilizado no pipeline
- Nenhuma predição está sendo realizada
- Integrações I-02 e I-03 não estão operacionais
- Service ausente impede comunicação entre módulos

IMPACTO OPERACIONAL:
- Pod está rodando e saudável (health checks OK)
- Modelos estão presentes e íntegros
- Container está configurado corretamente
- Mas o serviço não está sendo chamado pelo Decision Engine

CONCLUSÃO:
- ML-NSMF está DEPLOYADO mas NÃO INTEGRADO ao pipeline
- O Decision Engine não está chamando o ML-NSMF
- A Fase M está INSTÁVEL do ponto de vista de integração

============================================================
8. RECOMENDAÇÃO FINAL
============================================================

AÇÃO IMEDIATA NECESSÁRIA:
1. Atualizar imagem para v3.7.3-nasp (conforme Helm)
2. Criar Service Kubernetes para ML-NSMF
3. Verificar configuração do Decision Engine para chamar ML-NSMF
4. Remover pod duplicado em ImagePullBackOff
5. Validar integração I-02 (Decision Engine → ML-NSMF)
6. Validar integração I-03 (ML-NSMF → BC-NSSMF)

AÇÃO DE SINCRONIZAÇÃO:
1. Extrair código fonte do container para o repositório
2. Extrair modelos do container para o repositório (se necessário)
3. Sincronizar versão da imagem com Helm chart

NÃO SINCRONIZAR:
- O estado atual não está estável
- Integrações não estão operacionais
- Versão desatualizada em execução

============================================================
9. CONCLUSÃO OBRIGATÓRIA
============================================================

AUDITORIA NODE1 CONCLUÍDA — FASE M INSTÁVEL. NÃO SINCRONIZAR.

JUSTIFICATIVA:
- ML-NSMF está rodando mas não está integrado ao pipeline
- Nenhuma predição está sendo realizada
- Integrações I-02/I-03 não operacionais
- Versão desatualizada em execução
- Service Kubernetes ausente

============================================================
FIM DO RELATÓRIO
============================================================
